---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE, message=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
library(rmo)
library(tidyverse)
library(ggplot2)
set.seed(1623)
```

# rmo

<!-- badges: start -->
![minimal R version](https://img.shields.io/badge/R%3E%3D-3.3.0-6666ff.svg)
![packageversion](https://img.shields.io/badge/Package%20version-`r unname(desc::desc_get("Version"))`-orange.svg?style=flat-square)
[![Project Status: WIP â€“ Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](https://www.repostatus.org/badges/latest/wip.svg)](https://www.repostatus.org/#wip)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![Last-changedate](https://img.shields.io/badge/last%20change-`r gsub('-','--', Sys.Date())`-yellowgreen.svg)](/commits/master)
[![R build status](https://github.com/hsloot/rmo/workflows/R-CMD-check/badge.svg)](https://github.com/hsloot/rmo/actions)
[![Codecov test coverage](https://codecov.io/gh/hsloot/rmo/branch/master/graph/badge.svg)](https://codecov.io/gh/hsloot/rmo?branch=master)
<!-- badges: end -->

An R package for the *Marshall-Olkin distribution*: algorithms for the construction, simulation and estimation.

## Motivation

While the academic literature on the Marshall-Olkin distributions is extensive,
an intuitive and easy to use implementation is still missing. This project aims
to provide an `R` package makes it simple and fun to use Marshall-Olkin
distributions for research and real-world applications.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

```{r, include=TRUE, eval=FALSE}
# install.packages("devtools")
devtools::install_github("hsloot/rmo")
```

## Example

```{r, include=TRUE}
rmo_esm(n=10L, d=2L, intensities=c(1, 1, 1))
```

### Approximate an Alpha-Stable BF

```{r, include=TRUE}
alpha <- 0.5
bf <- AlphaStableBernsteinFunction(alpha=alpha)

x0 <- 5e-4
bf_approx <- SumOfBernsteinFunctions(
  first=LinearBernsteinFunction(
    scale = alpha*x0^(1-alpha)/(1-alpha)/gamma(1-alpha)
  ),
  second=ScaledBernsteinFunction(
    scale = x0^(-alpha)/gamma(1-alpha),
    original = ParetoBernsteinFunction(alpha=alpha, x0=x0)
  )
)
```

```{r,echo=FALSE, eval=TRUE}
d <- 15
tibble(
  i = 1:d,
  original = sapply(1:d, function(i) valueOf(bf, d-i, i)),
  approximation = sapply(1:d, function(i) valueOf(bf_approx, d-i, i))
) %>%
  gather("type", "ex_intensity[i]", -i) %>%
  ggplot(aes(x=i, y=`ex_intensity[i]`, colour=type)) +
    geom_point()
```



## Word of caution for high dimensions

While the package, including the simulation algorithms, is extensively tested
with unit tests, it can happen to run into unexpected results for certain
parametrisations in high dimensions. The reason for this  are numerical  issues
with very small and very large numbers. We tried to program defensively to avoid
these problems, but if the dimension is high enough and the parametrisation
leads to values below the double precision, at some point numerical issues are
inevitable.  For this reason, we encourage users to produce statistical tests
suitable for their use-case. An example can be found in
[https://github.com/hsloot/rmo/blob/master/other/integration-test.Rmd](https://github.com/hsloot/rmo/blob/master/other/integration-test.Rmd).
If you are encountering statistical problems, please submit an [issue report](https://github.com/hsloot/rmo/issues/new?assignees=&labels=bug&template=statistical_problem.md&title=%5BSTAT%5D)
including a [reprex](https://github.com/tidyverse/reprex).


## Roadmap for future development

We are planning to develop the package incrementally. The packages API might
change frequently without deprecation. The goal is to implement prototypes of
the algorithms in `R` and refactor them in compiled code afterwards. The
original `R` implementations are supposed to serve as test functions in the
unit-test harness.

As of now, we have completed the reimplementation of all sampling algorithms
in `Rcpp`. Our next steps are:

- __Version 0.3__: Refactor and document test and write new test cases to
  increase the coverage. Provide non trivial exchangeable and
  non-exchangeable parametrisations for testing.

Other ideas for the future:

- Implementation of estimation routines (__help wanted__).
- An *OOP* implementation of the Marshall--Olkin distribution with the ultimate
  goal to facilitate a hierarchical construction of Marshall--Olkin
  distributions.

## Contributing

Contribution is highly appreciated. Contribution can range from improving the
documentation, writing tests, or raising issues and feature requests to
implementing feature requests or fixing bugs. If you consider to contribute,
have a look at our [contribution guide](.github/CONTRIBUTING.md).



## License

GPL-3 Henrik Sloot
